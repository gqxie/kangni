<!DOCTYPE html>
<html>
{% load static %}
<head>
    <meta charset="utf-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>首页</title>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <style>
        body {
            margin: 10px;
        }

        .el-main {
            padding-bottom: 100px;
        }

        .el-footer {
            position: fixed;
            height: 100px;
            text-align: center;
            left: 0;
            right: 0;
            bottom: 0;
        }
        .el-drawer__body{
            margin-left: 20px;
        }
    </style>
</head>
<body>
<div id="app">
    <template>
        <el-container>
            <el-main>
                <el-table
                        stripe
                        :data="tableData"
                        style="width: 100%">
                    <el-table-column
                            type="selection"
                            width="55">
                    </el-table-column>
                    <el-table-column
                            type="index"
                            width="50"
                            label="序号">
                    </el-table-column>
                    <el-table-column
                            prop="cameraName"
                            label="名称"
                            width="180">
                    </el-table-column>
                    <el-table-column
                            prop="ip"
                            label="ip地址"
                            width="180">
                    </el-table-column>
                    <el-table-column
                            prop="cameraUseType"
                            label="用途"
                            width="180">
                    </el-table-column>
                    <el-table-column
                            prop="state"
                            label="状态"
                            width="120">
                        <template slot-scope="scope">
                            <el-tag
                                    :type="scope.row.state === '在线' ? 'success' : 'danger'"
                                    disable-transitions>{% templatetag openvariable %}
                                scope.row.state {% templatetag closevariable %}</el-tag>
                        </template>
                    </el-table-column>
                    <el-table-column label="操作">
                        <template slot-scope="scope">
                            <el-button-group>
                                <el-tooltip class="item" effect="dark" content="编辑" placement="top">
                                    <el-button type="primary" icon="el-icon-edit" size="mini"
                                               @click="handleEdit(scope.$index, scope.row)"></el-button>
                                </el-tooltip>
                                <el-tooltip class="item" effect="dark" content="分享" placement="top">
                                    <el-button type="primary" icon="el-icon-share" size="mini"
                                               @click="handleEdit(scope.$index, scope.row)"></el-button>
                                </el-tooltip>
                                <el-tooltip class="item" effect="dark" content="删除" placement="top">
                                    <el-button type="primary" icon="el-icon-delete" size="mini"
                                               @click="handleEdit(scope.$index, scope.row)"></el-button>
                                </el-tooltip>
                            </el-button-group>
                        </template>
                    </el-table-column>
                </el-table>

                <el-drawer
                        title="详情"
                        :visible.sync="drawer"
                        direction="rtl"
                        size="60%">
                    <el-tabs v-model="activeName" @tab-click="handleClick">
                        <el-tab-pane label="用户管理" name="first">用户管理</el-tab-pane>
                        <el-tab-pane label="配置管理" name="second">配置管理</el-tab-pane>
                        <el-tab-pane label="角色管理" name="third">角色管理</el-tab-pane>
                        <el-tab-pane label="定时任务补偿" name="fourth">定时任务补偿</el-tab-pane>
                    </el-tabs>
                </el-drawer>
            </el-main>

            <el-footer>
                <el-pagination
                        background
                        @size-change="handleSizeChange"
                        @current-change="handleCurrentChange"
                        :current-page.sync="currentPage"
                        :page-sizes="[10, 20, 50, 100]"
                        :page-size="currentSize"
                        layout="total, prev, pager, next, sizes"
                        :total="totalNum">
                </el-pagination>
            </el-footer>

        </el-container>
    </template>
</div>
<!-- import Vue before Element -->
<script src="https://unpkg.com/vue/dist/vue.js"></script>
<!-- import JavaScript -->
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script src="https://unpkg.com/axios@0.19.0/dist/axios.min.js"></script>
<script>
    new Vue({
        el: '#app',
        data() {
            return {
                tableData: [],
                currentPage: 1,
                currentSize: 10,
                totalNum: 0,
                drawer: false,
                activeName: 'second'
            };
        },
        created() {
            const _this = this;
            _this.getAllCamera(_this.currentPage, _this.currentSize)
        },
        methods: {
            handleSizeChange(val) {
                const _this = this;
                _this.currentSize = val;
                _this.currentPage = 1;
                _this.getAllCamera(_this.currentPage, _this.currentSize);
            },
            handleCurrentChange(val) {
                const _this = this;
                _this.currentPage = val;
                _this.getAllCamera(_this.currentPage, _this.currentSize);
            },
            getAllCamera(page, size) {
                const _this = this;
                axios({
                    method: 'get',
                    url: 'getAllCamera' + '?page=' + page + '&size=' + size
                }).then(function (resp) {
                    _this.tableData = resp.data.data;
                    _this.totalNum = resp.data.count;
                }).catch(resp => {
                    console.log('请求失败：' + resp.status + ',' + resp.statusText);
                });
            },
            handleEdit() {
                const _this = this;
                _this.drawer = true;
            },
            handleClick(tab, event) {
                console.log(tab, event);
            }
        }
    });
</script>
</body>
</html>
